# Terminal Extension Development Guide

Generated by `elfiee-ext-gen`

---

## Overview

This extension provides the following capabilities:

- **read**: TODO: Describe what this capability does

- **write**: TODO: Describe what this capability does


---

## Development Workflow

### 1. Define Payload Structure

Edit `mod.rs` - Replace the generic `serde_json::Value` with specific fields:


#### TerminalReadPayload

Suggested fields:
```rust
#[derive(Debug, Clone, Serialize, Deserialize, Type)]
pub struct TerminalReadPayload {
    
    /// Generic data field - replace with specific fields
    pub data: serde_json::Value,
    
}
```

#### TerminalWritePayload

Suggested fields:
```rust
#[derive(Debug, Clone, Serialize, Deserialize, Type)]
pub struct TerminalWritePayload {
    
    /// Generic data field - replace with specific fields
    pub data: serde_json::Value,
    
}
```


**Action Items**:
- [ ] Define all required fields with appropriate types
- [ ] Add documentation for each field
- [ ] Remove the generic `data: serde_json::Value` field

---

### 2. Implement Handler Logic


#### File: `terminal_read.rs`

Replace the `todo!()` markers with actual implementation:

```rust
#[capability(id = "terminal.read", target = "terminal")]
pub fn handle_read(cmd: &Command, block: Option<&Block>) -> CapResult<Vec<Event>> {
    // 1. Deserialize payload
    let payload: TerminalReadPayload = serde_json::from_value(cmd.payload.clone())
        .map_err(|e| format!("Failed to deserialize payload: {}", e))?;

    // 2. Validate input
    // ... your validation logic ...

    // 3. Perform operation
    // ... your business logic ...

    // 4. Create events
    Ok(vec![Event {
        // ... event fields ...
    }])
}
```

#### File: `terminal_write.rs`

Replace the `todo!()` markers with actual implementation:

```rust
#[capability(id = "terminal.write", target = "terminal")]
pub fn handle_write(cmd: &Command, block: Option<&Block>) -> CapResult<Vec<Event>> {
    // 1. Deserialize payload
    let payload: TerminalWritePayload = serde_json::from_value(cmd.payload.clone())
        .map_err(|e| format!("Failed to deserialize payload: {}", e))?;

    // 2. Validate input
    // ... your validation logic ...

    // 3. Perform operation
    // ... your business logic ...

    // 4. Create events
    Ok(vec![Event {
        // ... event fields ...
    }])
}
```


---

### 3. Run Tests

```bash
cargo test terminal::tests
```

**Expected progression**:
1. All tests fail initially (expected)
2. After defining payloads: some tests pass
3. After implementing handlers: more tests pass
4. After full implementation: all tests pass âœ…

---

## Testing Checklist

- [ ] All payload fields are properly defined
- [ ] All handlers are implemented (no `todo!()` remaining)
- [ ] All tests pass (`cargo test`)
- [ ] Code is documented
- [ ] Edge cases are handled

---

## Next Steps

1. Run initial tests: `cargo test terminal::tests`
2. Follow the failing tests to implement features incrementally
3. Use `elfiee-ext-gen guide terminal` to track progress

Good luck! ðŸš€
