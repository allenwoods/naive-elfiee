/// Directory Extension
///
/// Generated by elfiee-ext-gen - Modify as needed
use serde::{Deserialize, Serialize};
use specta::Type;

// ============================================================================
// Shared Utilities
// ============================================================================

mod utils;

// ============================================================================
// Module Exports
// ============================================================================

pub mod directory_list;
pub use directory_list::*;

pub mod directory_create;
pub use directory_create::*;

pub mod directory_delete;
pub use directory_delete::*;

pub mod directory_rename;
pub use directory_rename::*;

pub mod directory_refresh;
pub use directory_refresh::*;

pub mod directory_watch;
pub use directory_watch::*;

pub mod directory_search;
pub use directory_search::*;

// ============================================================================
// Payload Definitions
// ============================================================================

/// Payload for DirectoryList
#[derive(Debug, Clone, Serialize, Deserialize, Type)]
pub struct DirectoryListPayload {
    /// Path to list (relative to Block.contents.root; use "." for the root)
    pub path: String,

    /// Whether to recursively list subdirectories
    #[serde(default)]
    pub recursive: bool,

    /// Whether to include hidden files (starting with '.')
    #[serde(default)]
    pub include_hidden: bool,

    /// Maximum recursion depth (None = unlimited)
    #[serde(default)]
    pub max_depth: Option<usize>,
}

/// Creates a new file or directory.
#[derive(Debug, Clone, Serialize, Deserialize, Type)]
pub struct DirectoryCreatePayload {
    /// Path to create (relative to Block.contents.root)
    pub path: String,

    /// Type of item: "file" or "dir"
    pub item_type: String,

    /// Initial content for files (empty string for empty file)
    #[serde(default)]
    pub content: String,
}

/// Deletes a file or directory.
#[derive(Debug, Clone, Serialize, Deserialize, Type)]
pub struct DirectoryDeletePayload {
    /// Path to delete (relative to Block.contents.root)
    pub path: String,

    /// Whether to recursively delete directories
    #[serde(default)]
    pub recursive: bool,
}

/// Renames or moves a file/directory.
#[derive(Debug, Clone, Serialize, Deserialize, Type)]
pub struct DirectoryRenamePayload {
    /// Old path (relative to Block.contents.root)
    pub old_path: String,

    /// New path (relative to Block.contents.root)
    pub new_path: String,
}

/// Refreshes the directory cache.
#[derive(Debug, Clone, Serialize, Deserialize, Type)]
pub struct DirectoryRefreshPayload {
    /// Whether to recursively refresh subdirectories
    #[serde(default)]
    pub recursive: bool,
}

/// Enables/disables file system watching.
#[derive(Debug, Clone, Serialize, Deserialize, Type)]
pub struct DirectoryWatchPayload {
    /// Whether to enable watching
    pub enabled: bool,
}

/// Searches for files by pattern.
#[derive(Debug, Clone, Serialize, Deserialize, Type)]
pub struct DirectorySearchPayload {
    /// Search pattern (supports wildcards like *.rs)
    pub pattern: String,

    /// Whether to recursively search subdirectories
    #[serde(default = "default_true")]
    pub recursive: bool,

    /// Whether to include hidden files
    #[serde(default)]
    pub include_hidden: bool,
}

fn default_true() -> bool {
    true
}
// ============================================================================
// Tests
// ============================================================================

#[cfg(test)]
mod tests;
