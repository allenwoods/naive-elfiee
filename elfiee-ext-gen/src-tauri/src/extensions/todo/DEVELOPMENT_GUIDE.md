# Todo Extension Development Guide

Generated by `elfiee-ext-gen`

---

## Overview

This extension provides the following capabilities:

- **add_item**: TODO: Describe what this capability does

- **toggle_item**: TODO: Describe what this capability does


---

## Development Workflow

### 1. Define Payload Structure

Edit `mod.rs` - Replace the generic `serde_json::Value` with specific fields:


#### TodoAddItemPayload

Suggested fields:
```rust
#[derive(Debug, Clone, Serialize, Deserialize, Type)]
pub struct TodoAddItemPayload {
    
    /// The text content to add
    pub text: String,
    
    /// Optional priority level
    pub priority: Option<u32>,
    
}
```

#### TodoToggleItemPayload

Suggested fields:
```rust
#[derive(Debug, Clone, Serialize, Deserialize, Type)]
pub struct TodoToggleItemPayload {
    
    /// ID of the item to toggle
    pub item_id: String,
    
    /// New status
    pub status: bool,
    
}
```


**Action Items**:
- [ ] Define all required fields with appropriate types
- [ ] Add documentation for each field
- [ ] Remove the generic `data: serde_json::Value` field

---

### 2. Implement Handler Logic


#### File: `todo_add_item.rs`

Replace the `todo!()` markers with actual implementation:

```rust
#[capability(id = "todo.add_item", target = "todo")]
pub fn handle_add_item(cmd: &Command, block: Option<&Block>) -> CapResult<Vec<Event>> {
    // 1. Deserialize payload
    let payload: TodoAddItemPayload = serde_json::from_value(cmd.payload.clone())
        .map_err(|e| format!("Failed to deserialize payload: {}", e))?;

    // 2. Validate input
    // ... your validation logic ...

    // 3. Perform operation
    // ... your business logic ...

    // 4. Create events
    Ok(vec![Event {
        // ... event fields ...
    }])
}
```

#### File: `todo_toggle_item.rs`

Replace the `todo!()` markers with actual implementation:

```rust
#[capability(id = "todo.toggle_item", target = "todo")]
pub fn handle_toggle_item(cmd: &Command, block: Option<&Block>) -> CapResult<Vec<Event>> {
    // 1. Deserialize payload
    let payload: TodoToggleItemPayload = serde_json::from_value(cmd.payload.clone())
        .map_err(|e| format!("Failed to deserialize payload: {}", e))?;

    // 2. Validate input
    // ... your validation logic ...

    // 3. Perform operation
    // ... your business logic ...

    // 4. Create events
    Ok(vec![Event {
        // ... event fields ...
    }])
}
```


---

### 3. Run Tests

```bash
cargo test todo::tests
```

**Expected progression**:
1. All tests fail initially (expected)
2. After defining payloads: some tests pass
3. After implementing handlers: more tests pass
4. After full implementation: all tests pass âœ…

---

## Testing Checklist

- [ ] All payload fields are properly defined
- [ ] All handlers are implemented (no `todo!()` remaining)
- [ ] All tests pass (`cargo test`)
- [ ] Code is documented
- [ ] Edge cases are handled

---

## Next Steps

1. Run initial tests: `cargo test todo::tests`
2. Follow the failing tests to implement features incrementally
3. Use `elfiee-ext-gen guide todo` to track progress

Good luck! ðŸš€
