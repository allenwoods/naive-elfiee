/// Capability: {{ capability_id }}
///
/// Generated by elfiee-ext-gen - Implement the logic below

use super::{{ capability_struct_name }}Payload;
use crate::capabilities::core::{create_event, CapResult}; // remove `create_event` if the capability does not emit events
use crate::models::{Block, Command, Event};
use capability_macros::capability;

/// Handler for {{ capability_id }} capability.
///
/// TODO: Implement the capability logic here.
///
/// # Arguments
/// * `cmd` - The command containing the payload
/// * `block` - Optional block to operate on
///
/// # Returns
/// * `Ok(Vec<Event>)` - Events to be committed
/// * `Err(String)` - Error description
///
#[capability(id = "{{ extension_name }}.{{ capability_id }}", target = "{{ block_type }}")]
fn handle_{{ capability_id_snake }}(cmd: &Command, block: Option<&Block>) -> CapResult<Vec<Event>> {
    // TODO: Step 1 - Deserialize payload
    todo!("Deserialize {{ capability_struct_name }}Payload from cmd.payload");

    // TODO: Step 2 - Validate input
    // if payload.data.is_null() {
    //     return Err("Invalid data".to_string());
    // }

    // TODO: Step 3 - Perform operation
    // let result = perform_operation(&payload, block)?;

    // TODO: Step 4 - Create events
    // If this capability does not emit events, return Ok(vec![]) and remove `create_event` import.
    // let event = create_event(
    //     block.unwrap().block_id.clone(),
    //     "{{ extension_name }}.{{ capability_id }}",
    //     serde_json::json!({ "result": "value" }),
    //     &cmd.editor_id,
    //     1,
    // );
    // Ok(vec![event])
}
