# 1. 一阶段工作回顾

## 1.1. 总体目标
聚焦"统一工作面"和"决策资产化"，开发和验证 Elfiee 作为多角色协作平台的基础能力。

## 1.2. 产品工作：
* 原型搭建
* 竞品分析
* 用户故事快速实验

## 1.3. 研发工作
* Dashboard、Directory、编辑界面、协作者/权限、Event记录和回溯等功能开发
* 完成一个在“单人单机”场景下，支持“多角色协同文件管理和编辑”和“记录/回溯操作历史”的Demo。

# 2. 产品关注的核心命题

## 2.1. 痛点分析

* 需求分散记录：需求以PRD、聊天记录等形式存在，无法区分硬性约束、背景信息、验收标准等内容，也无法形成逻辑链条。这类分散的记录方式在提高循环迭代，特别是AI参与的敏捷任务中，显得笨重和低效。

* 记录无法复用：需求、实现、验证没有被沉淀为可复用的资产，无法服务于效率高可验证性差的AI协同和开发。

## 核心命题：

“让决策可学习”：

具体拆解为两个递进方向：

|方向|问题域|对抗的问题|
|------|---------|---------|
|把决策记录下来	|「发生了什么」+「为什么这么做」|决策失忆|
|让记录的内容可学习|记录下来的东西能被复用、被计算、被进化|知识无法资产化|

**Elfiee定位**：AI原生编辑器 -- 把意图、实现、验证、逻辑链条串在一起的中间媒介，记录全链条决策，并沉淀为可复用资产，反哺AI时代的敏捷开发和验证。

# 3. 一阶段的产品工作

| 工作模块 | 具体内容 | 产出物 |
| :--- | :--- | :--- |
| **竞品分析** | 三种代表性流程（大厂、Google、Vibe Coding）的共性问题分析 | `竞品分析 insight 1.md`, `insight 2-3.md` |
| **实验设计** | 两个核心实验：① 记录行为的 Effort vs Value ② 不同记录形式的 Benefit 对比 | `实验设计.md` |
| **实验执行与报告** | 定量（Coverage/Accuracy）+ 定性（Difficulty/Confidence/Helpfulness）结果 | `实验报告.md` |
| **产品方向收束** | 从「让决策可学习」出发，收束产品方向 | `Phase_1_Summary_让决策可学习.md` |

# 4. 一阶段的产品工作结论

## 4.1. 核心发现

1. 单纯的 Log 是无效的：信息密度太低，增加阅读负担
2. 结构化 Tag 不够：用户需要脑补，反而降低信心
3. Summary 是方向：主观体验最好，但在复杂决策中会产生「主观信心 ≠ 客观正确」的幻觉
4. 必须配合 Traceability：Summary 不能是黑盒，必须能回溯证据链

## 4.2. 关键结论
**(需要确认和补充)**
* ❌ 不成立的假设："只要把决策记录下来效率就会提升"
* ✅ 成立的假设：“在提高效率的前提下，用户接受将决策记录下来的动作，并愿意进行提炼和总结”
* 决策资产化的价值不在于给人读，而在于让 AI 学。因此二阶段的重点不是优化决策的展示形式，而是让 AI 能够接入协作流程、消费这些决策数据。

# 5. 一阶段的工作Gap
**(需要确认和补充)**
| Gap | 描述 | 与理想状态的差距 |
| :--- | :--- | :--- |
| **AI 未接入** | 当前系统只有「人类角色」，没有 AI Agent 参与协作 | 无法验证「AI原生编辑器」的核心假设 |
| **逻辑链条不可见** | Event 被记录了，但 Event 之间的因果关系（DAG）未被建模和可视化 | 无法追溯「这个决策依赖哪些前提，造成哪些影响」 |
| **验证闭环缺失** | 没有 Terminal 连接外部工具链（cargo, npm），无法在 Elfiee 内完成「需求→实现→测试→验证」的闭环 | 无法通过 Dogfooding进行闭环验证 |
| **决策表达层薄弱** | 当前只有「纯文本 + Event Log」，缺少结构化的决策表达（Rule / Flow / Summary） | 无法验证「可学习」的第二层目标 |

# 6. 一阶段Gap归隐分析

1. 请从产品优先级排序的角度解释：为什么一阶段没有做这些？
2. 这些没做是主动取舍（资源有限、验证优先级不高），还是被动遗留（没想到、低估了重要性）？
3. 这些是不是二阶段的工作方向和目标？

# 7. 二阶段工作方向

## 7.1. 一阶段实验的启示：

从实验结论说明，提供更多信息给人效果不显著（F2/F3/F4 的定量指标均未优于F1），而让 AI参与消费决策尚未验证，但这是让决策可学习的核心路径。

## 7.2. 二阶段聚焦点：
**(需要确认和补充)**
| 方向 | 描述 | 对应模块 |
| :--- | :--- | :--- |
| **AI 接入协作** | 让AI Agent以“编辑者”身份参与协作，消费历史决策 | Agent Block Extension |
| **打通验证闭环** | 让Elfiee能连接外部工具链，完成“需求→实现→测试”闭环 | Terminal Extension |
| **建立因果索引** | 为Event之间建立因果关系，支撑未来的DAG可视化 | Relation 增强 |

## 7.3. 二阶段不做什么
**(需要确认和补充)**
| 不做 | 原因 |
| :--- | :--- |
| ❌ **更细的 Log 系统** | 实验证明：信息密度太低，对人无效 |
| ❌ **复杂的 DAG 可视化** | 数据结构先行，可视化推迟到三阶段 |
| ❌ **决策形式的深度优化 (Rule / Flow)** | 等 AI 接入后，再验证 AI 消费决策的效果 |
| ❌ **CBAC 权限的细化** | 已具备基础能力，暂不深入 |

# 8. 二阶段场景：Dogfooding
1. Dogfooding：用 Elfiee 开发 Elfiee，让团队自己成为第一批用户。

2. Dogfooding要验证什么：
**(需要确认和补充)**
| 验证目标 | 具体指标 | 判断标准 |
| :--- | :--- | :--- |
| **AI 能作为协作者** | Agent 能读取需求、生成代码、建立 Relation | 完成一个完整的「需求→代码→测试」流程 |
| **验证闭环成立** | 在 Terminal 中运行测试并通过 | 不需要离开 Elfiee 去外部终端 |
| **决策可追溯** | Agent 生成的代码能追溯到需求 Block | 通过 Relation 可视化查看 |

3.  Dogfooding的成功标准
**(需要确认和补充)**
* 完成一个真实功能开发
* 完成完整记录
* 记录喂给AI有帮助等等数值标准

# 9. 二阶段产品核心产物
1. 产研分工
**(需要确认和补充)**
| 职责 | 产品 | 研发 |
| :--- | :---: | :---: |
| **定义 What** | ✅ 主导 | 评审 |
| **定义 How it works（数据结构、API）** | 评审 | ✅ 主导 |
| **定义 How it looks（UI/UX）** | 规范输出 | 最小实现 → 迭代优化 |
| **Dogfooding 跟踪** | ✅ 主导 | 配合 |
| **问题收集与优先级排序** | ✅ 主导 | 执行 |

2. 产品二阶段产出物
**(需要确认和补充)**
| 产出物 | 描述 | 
| :--- | :--- | 
| **本报告（一阶段总结）** | 收束一阶段，指导二阶段方向 | 
| **Agent 交互规范** | 定义 Proposal 结构、Agent 触发方式、输入输出 Schema |
| **Terminal 交互规范** | 定义导出检查的触发条件、用户选项 | 
| **Dogfooding 问题清单** | 持续记录 Dogfooding 过程中的问题和改进建议 | 
| **迭代方案（可选）** | 基于 Dogfooding 反馈的改进设计 | 

# 10 交互规范格式建议：
··· yaml
# Agent 交互规范 v1

## 1. 触发方式
- 用户在任意 Block 中 @AgentName
- 用户点击 Agent Block 的「Invoke」按钮

## 2. Agent 输入
- 当前 Block 的内容
- Agent 关联的 children Blocks（Directory、Terminal）的元信息

## 3. Agent 输出（Proposal 结构）
{
  "proposal_id": "uuid",
  "proposed_commands": [
    {
      "action": "block.create",
      "params": { "type": "code", "path": "src/pdf.rs" }
    },
    {
      "action": "code.write",
      "params": { "block_id": "xxx", "content": "..." }
    }
  ],
  "reasoning": "根据需求 Block 的描述，我建议创建..."
}

## 4. 审批流程
- 用户看到 Proposal 卡片（包含 Diff 预览）
- 用户点击 Approve → 系统依次执行 commands
- 用户点击 Reject → Proposal 标记为 Rejected，不执行
```